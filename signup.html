<!DOCTYPE html>
<html>
<head>
  <title>mvhdBot â€“ Login / Signup</title>
</head>
<body>
  <h1>Welcome to mvhdBot</h1>
  <p>Automatic sniper trading robot using PocketBase</p>

  <button onclick="showLogin()">Login</button>
  <button onclick="showSignup()">Signup</button>

  <div id="authForm"></div>

  <script type="module">
    import PocketBase from 'https://cdn.jsdelivr.net/npm/pocketbase@0.18.3/+esm';

    // Replace with your local or ngrok URL
    const pb = new PocketBase('http://127.0.0.1:8090');

    function showLogin() {
      document.getElementById('authForm').innerHTML = `
        <h3>Login</h3>
        <input id="email" placeholder="Email"><br>
        <input id="password" placeholder="Password" type="password"><br>
        <button onclick="login()">Submit</button>
      `;
    }

    function showSignup() {
      document.getElementById('authForm').innerHTML = `
        <h3>Signup</h3>
        <input id="email" placeholder="Email"><br>
        <input id="password" placeholder="Password" type="password"><br>
        <button onclick="signup()">Submit</button>
      `;
    }

    // Expose functions globally
    window.login = async function () {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      try {
        const result = await pb.collection('users').authWithPassword(email, password);
        alert('Logged in successfully!');
        console.log(result);
      } catch (err) {
        alert('Login failed');
        console.error(err);
      }
    };

    window.signup = async function () {
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;

      try {
        const result = await pb.collection('users').create({
          email,
          password,
          passwordConfirm: password
        });
        alert('Signup successful!');
        console.log(result);
      } catch (err) {
        alert('Signup failed');
        console.error(err);
      }
    };
  </script>
</body>
</html>
